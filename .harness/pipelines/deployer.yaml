pipeline:
    name: deployer
    identifier: deployer
    projectIdentifier: deployer
    orgIdentifier: default
    tags: {}
    stages:
        - parallel:
              - stage:
                    name: deploy1
                    identifier: deploy1
                    description: ""
                    type: Deployment
                    spec:
                        serviceConfig:
                            serviceRef: loki
                            serviceDefinition:
                                spec:
                                    variables: []
                                    manifests:
                                        - manifest:
                                              identifier: loki
                                              type: HelmChart
                                              spec:
                                                  store:
                                                      type: Http
                                                      spec:
                                                          connectorRef: account.grafanahelm
                                                  chartName: loki
                                                  chartVersion: <+input>
                                                  helmVersion: V3
                                                  skipResourceVersioning: false
                                type: Kubernetes
                        infrastructure:
                            environmentRef: staging
                            infrastructureDefinition:
                                type: KubernetesDirect
                                spec:
                                    connectorRef: account.kubernetesconnector
                                    namespace: default
                                    releaseName: loki
                            allowSimultaneousDeployments: true
                        execution:
                            steps:
                                - step:
                                      name: Rollout Deployment
                                      identifier: rolloutDeployment
                                      type: K8sRollingDeploy
                                      timeout: 10m
                                      spec:
                                          skipDryRun: false
                            rollbackSteps:
                                - step:
                                      name: Rollback Rollout Deployment
                                      identifier: rollbackRolloutDeployment
                                      type: K8sRollingRollback
                                      timeout: 10m
                                      spec: {}
                    tags: {}
                    failureStrategies:
                        - onFailure:
                              errors:
                                  - AllErrors
                              action:
                                  type: StageRollback
              - stage:
                    name: test
                    identifier: test
                    description: ""
                    type: Deployment
                    spec:
                        serviceConfig:
                            serviceRef: loki
                            serviceDefinition:
                                spec:
                                    variables: []
                                    manifests:
                                        - manifest:
                                              identifier: loki
                                              type: HelmChart
                                              spec:
                                                  store:
                                                      type: Http
                                                      spec:
                                                          connectorRef: account.grafanahelm
                                                  chartName: loki
                                                  chartVersion: <+input>
                                                  helmVersion: V3
                                                  skipResourceVersioning: false
                                type: NativeHelm
                        infrastructure:
                            environmentRef: staging
                            infrastructureDefinition:
                                type: KubernetesDirect
                                spec:
                                    connectorRef: account.kubernetesconnector
                                    namespace: default
                                    releaseName: loki
                            allowSimultaneousDeployments: true
                        execution:
                            steps:
                                - step:
                                      name: Helm Deployment
                                      identifier: helmDeployment
                                      type: HelmDeploy
                                      timeout: 10m
                                      spec:
                                          skipDryRun: false
                            rollbackSteps:
                                - step:
                                      name: Helm Rollback
                                      identifier: helmRollback
                                      type: HelmRollback
                                      timeout: 10m
                                      spec: {}
                    tags: {}
                    failureStrategies:
                        - onFailure:
                              errors:
                                  - AllErrors
                              action:
                                  type: StageRollback
